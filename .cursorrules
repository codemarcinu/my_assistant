### ğŸ’¥ CRITICAL ANTI-PATTERNS â€” NEVER DO THESE

```
# â›” Relatywne importy skracane (â€..â€, â€.â€) w kodzie backendu
# â›” Duplikaty nazw klas SQLAlchemy w rÃ³Å¼nych moduÅ‚ach
# â›” Tworzenie kontenerÃ³w Docker bez instrukcji HEALTHCHECK
# â›” Hard-code kluczy, haseÅ‚ lub tokenÃ³w w kodzie ÅºrÃ³dÅ‚owym
# â›” UÅ¼ycie TypeScript typu â€anyâ€ lub wyÅ‚Ä…czanie strict mode
# â›” Pomijanie testÃ³w @pytest.mark.asyncio dla funkcji asynchronicznych
# â›” Build Next.js App Router z deprecated Pages Router API
# â›” Brak CORS-middleware albo zbyt szerokie allow_origins ["*"]
# â›” Logika biznesowa w warstwie routingowej FastAPI
```


### âœ… REQUIRED PATTERNS â€” ALWAYS DO THESE

```
# ğŸ“ Struktura
â”œâ”€â”€ src/backend/               # Python 3.12 + FastAPI
â”‚   â”œâ”€â”€ main.py                # Instancja FastAPI "app"
â”‚   â”œâ”€â”€ api/                   # End-pointy (routery)
â”‚   â”œâ”€â”€ models/                # SQLAlchemy + Pydantic
â”‚   â”œâ”€â”€ services/              # Logika domenowa
â”‚   â””â”€â”€ tests/                 # Unit + integration
â”œâ”€â”€ foodsave-frontend/         # Next.js 14 (TypeScript strict)
â”‚   â””â”€â”€ tests/                 # Jest + Playwright
â”œâ”€â”€ docker-compose.yaml        # Komplet usÅ‚ug + healthchecks
â””â”€â”€ .env[example]              # Wymagane zmienne Å›rodowiskowe
```

```
# ğŸ Python / FastAPI
ALWAYS use type hints & Pydantic models for every request/response          # [^1][^2]
ALWAYS declare dependencies via Depends() â€“ Å¼adnych poÅ‚Ä…czeÅ„ DB w routerze
ALWAYS register kaÅ¼dÄ… klasÄ™ agenta w AgentFactory, z bezpiecznym fallback   # [^2]
ALWAYS implement /health, /ready, /metrics endpoints                       # [^2][^21]
ALWAYS configure CORS: allow_origins=["http://localhost:3000"]             # [^2]
```

```
# ğŸ³ Docker / Compose
ALWAYS define HEALTHCHECK for every service (backend, db, vector-store)     # [^25]
ALWAYS expose only niezbÄ™dne porty; uÅ¼ywaj networks: internal
ALWAYS use env_file: .env  â€“ Å¼adnych sekretÃ³w w docker-compose.yaml
ALWAYS set restart: unless-stopped dla usÅ‚ug krytycznych
```

```
# âš›ï¸ Next.js 14 (TypeScript)
ALWAYS enable "strict": true w tsconfig.json                               # [^27]
ALWAYS run "tsc --noEmit" w pipeline przed `next build`
ALWAYS dodaj React Error Boundaries dla komponentÃ³w klienta
ALWAYS uÅ¼ywaj React Query z prawidÅ‚owym invalidation po mutacjach          # [^2]
```

```
# ğŸ” BezpieczeÅ„stwo
ALWAYS uÅ¼ywaj HTTPS w Å›rodowisku prod (Traefik / Caddy / nginx TLS)        # [^28]
ALWAYS skanuj zaleÅ¼noÅ›ci `poetry export` + `npm audit`
ALWAYS implementuj rate limiting (Starlette middleware + key-func IP)      # [^28]
ALWAYS loguj z kontekstem (structured logging, brak danych wraÅ¼liwych)     # [^2]
```


### ğŸ§ª TESTING REQUIREMENTS

```
REQUIRED pytest.ini â†’ addopts = --strict-markers --cov=src --cov-report=html   # [^2]
REQUIRED markers: unit / integration / e2e                                    # [^2]
REQUIRED async tests â‡’ @pytest.mark.asyncio                                   # [^26]
REQUIRED Playwright specs dla kluczowych user flows (â€add foodâ€, â€donateâ€)    # [^2]
```


### ğŸ”„ PRODUCTION-READINESS CHECKLIST (Pre-merge Gate)

```
[ ] docker compose config --quiet    # brak bÅ‚Ä™dÃ³w skÅ‚adni
[ ] docker compose up -d && ./scripts/wait-for-services.sh
[ ] curl http://localhost:8000/health â†’ 200 {"status":"healthy"}
[ ] npm run type-check (frontend)    # zero TS errors
[ ] poetry run pytest -q             # wszystkie testy przechodzÄ…
[ ] Coverage â‰¥ 90 % backend, â‰¥ 80 % frontend
[ ] npm run test:e2e --browser=chromium --reporter=html
[ ] git diff â†’ brak TODO/FIXME w kodzie
[ ] docs/ aktualne (OpenAPI / README + CHANGELOG)
[ ] Grafana dashboard â†’ alert rules configured
```


### ğŸ› ï¸ INTEGRACJA Z CI/CD

```
# .github/workflows/quality-check.yml
- name: Cursor-Rules Validation
  run: python scripts/validate_rules.py                                       # [^1]
- name: Production-Readiness Checklist
  run: ./scripts/pr_checklist.sh                                              # [^21]
```
